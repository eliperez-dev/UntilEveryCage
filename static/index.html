<!--
    Until Every Cage is Empty
    Copyright (C) 2025 Eli Perez 

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program. If not, see <https://www.gnu.org/licenses/>.

    Contact the developer directly at untileverycageproject@protonmail.com
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>Until Every Cage is Empty</title>
    <meta name="title" content="Until Every Cage is Empty" />
    <meta name="description" content="An interactive map exposing the infrastructure of animal exploitation in the United States. Visualize thousands of facilities including slaughterhouses, processing plants, labs, farms/breeders, dealers, and exhibitors." />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://untileverycage.org/" />
    <meta property="og:title" content="Until Every Cage is Empty" />
    <meta property="og:description" content="An interactive map exposing the infrastructure of animal exploitation in the United States. Visualize thousands of facilities including slaughterhouses, processing plants, labs, farms/breeders, dealers, and exhibitors." />
    <meta property="og:image" content="https://untileverycage.org/assets/icon.png" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://untileverycage.org/" />
    <meta property="twitter:title" content="Until Every Cage is Empty" />
    <meta property="twitter:description" content="An interactive map exposing the infrastructure of animal exploitation in the United States. Visualize thousands of facilities including slaughterhouses, processing plants, labs, farms/breeders, dealers, and exhibitors." />
    <meta property="twitter:image" content="https://untileverycage.org/assets/icon.png" />


    <link rel="icon" type="image/png" href="assets/icon.png">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="map-filter-styles.css" />
</head>

<body>


<header class="site-header">
    <div class="header-container">
        <h1 data-i18n="app.title">Until Every Cage is Empty</h1>
        <nav class="main-navigation">
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link active" data-i18n="nav.map">Map</a></li>
                <li><a href="howtouse.html" class="nav-link" data-i18n="nav.howToUse">How To Use</a></li>
                <li><a href="about.html" class="nav-link" data-i18n="nav.about">About</a></li>
                <!-- <li><a href="contribute.html" class="nav-link" data-i18n="nav.contribute">Contribute</a></li> -->
                <li>
                    <select id="language-selector" class="nav-link" style="background: #333; color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; cursor: pointer; padding: 2px 5px;">
                        <option value="en">ğŸ‡ºğŸ‡¸ EN</option>
                        <option value="es">ğŸ‡ªğŸ‡¸ ES</option>
                        <option value="fr">ğŸ‡«ğŸ‡· FR</option>
                        <option value="de">ğŸ‡©ğŸ‡ª DE</option>
                    </select>
                </li>
            </ul>
        </nav>
    </div>
</header>
<div id="map-container">
    <div id="map">
        <!-- Loading indicator -->
        <div id="loading-indicator">
            <div class="loading-spinner"></div>
            <div class="loading-text" data-i18n="loading.text">Loading map data...</div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-percentage">0%</div>
            </div>
        </div>
    </div>

    <!-- Drawer Toggle Button -->
    <button id="drawer-toggle-btn" class="drawer-toggle-btn" type="button" aria-label="Toggle search drawer" title="Open search and filters">
        <span class="drawer-toggle-icon">â˜°</span>
    </button>

    <!-- Side Drawer -->
    <div id="search-drawer" class="search-drawer" role="region" aria-label="Search and filter panel">
        <div class="drawer-header">
            <h2 data-i18n="drawer.title">Search & Filter</h2>
            <button id="drawer-close-btn" class="drawer-close-btn" type="button" aria-label="Close search drawer">âœ•</button>
        </div>

        <div class="drawer-content">
            <!-- Search Section -->
            <div class="drawer-section search-section">
                <h3 class="section-title" data-i18n="drawer.search.title">Search</h3>
                <div class="search-input-wrapper">
                    <input type="text" id="name-search-input" placeholder="Search facilities, animals, companies..." data-i18n="drawer.search.placeholder" aria-label="Search facilities by name" class="search-input">
                    <div id="search-results-dropdown" class="search-results-dropdown"></div>
                </div>
            </div>

            <!-- Location Section -->
            <div class="drawer-section">
                <h3 class="section-title" data-i18n="drawer.location.title">Location</h3>
                <div class="location-filters">
                    <select id="country-selector" aria-label="Filter by country" class="filter-select">
                        <option value="all" data-i18n="drawer.location.allCountries">All Countries</option>
                    </select>
                    <select id="state-selector" aria-label="Filter by state/province" class="filter-select">
                        <option value="all" data-i18n="drawer.location.allStates">All States/Provinces</option>
                    </select>
                </div>
            </div>

            <!-- Facility Types Section -->
            <div class="drawer-section">
                <h3 class="section-title" data-i18n="drawer.types.title">Facility Types</h3>
                <div class="types-grid">
                    <div class="checkbox-item">
                        <input type="checkbox" id="slaughterhousesCheckbox" checked> 
                        <label for="slaughterhousesCheckbox" data-i18n="drawer.types.slaughterhouses">ğŸ”´ Slaughterhouses</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="meatProcessingPlantsCheckbox" checked>
                        <label for="meatProcessingPlantsCheckbox" data-i18n="drawer.types.processing">âšªï¸ Processing</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="testingLabsCheckbox" checked>
                        <label for="testingLabsCheckbox" data-i18n="drawer.types.labs">ğŸŸ£ Labs</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="breedersCheckbox" checked>
                        <label for="breedersCheckbox" data-i18n="drawer.types.breeders">ğŸŸ¡ Farms / Breeders</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="dealersCheckbox" checked>
                        <label for="dealersCheckbox" data-i18n="drawer.types.dealers">ğŸŸ  Dealers</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="exhibitorsCheckbox" checked>
                        <label for="exhibitorsCheckbox" data-i18n="drawer.types.exhibitors">ğŸŸ¢ Exhibitors/Zoos</label>
                    </div>
                </div>
            </div>

            <!-- Export & Settings Section -->
            <div class="drawer-section">
                <h3 class="section-title" data-i18n="drawer.export.title">Export & Settings</h3>
                <div class="action-buttons">
                    <button id="share-view-btn" class="action-btn primary-btn" data-i18n="drawer.export.share">Share View</button>
                    <button id="download-csv-btn" class="action-btn primary-btn" data-i18n="drawer.export.download">Download CSV</button>
                    <button id="reset-filters-btn" class="action-btn secondary-btn" data-i18n="drawer.export.reset">Reset Filters</button>
                </div>
            </div>

            <!-- Clustering Section -->
            <div class="drawer-section">
                <h3 class="section-title" data-i18n="drawer.display.title">Display Settings</h3>
                <p class="slider-label"><span data-i18n="drawer.display.clusterLabel">Cluster after</span> <span id="cluster-value">1750</span> <span data-i18n="drawer.display.facilities">facilities</span></p>
                <input type="range" id="cluster-threshold-slider" min="0" max="10000" step="200" value="1750" class="threshold-slider">
                <small data-i18n="drawer.display.clusterHelp">Lower values = earlier clustering.</small>
                
                <hr style="margin: 16px 0; border: none; border-top: 1px solid #e0e0e0;">
                
                <p class="slider-label"><span data-i18n="drawer.display.pinSize">Pin Size</span>: <span id="icon-size-value">1.0</span>x</p>
                <input type="range" id="icon-size-slider" min="0.5" max="2.0" step="0.1" value="1" class="threshold-slider">
                <small data-i18n="drawer.display.pinSizeHelp">Higher values = larger markers.</small>
            </div>

            <!-- Stats Section -->
            <div class="drawer-section stats-section">
                <div id="stats-container"></div>
            </div>
        </div>
    </div>

    <!-- Drawer Backdrop -->
    <div id="drawer-backdrop" class="drawer-backdrop"></div>

    <!-- First-Time Visitor Modal -->
    <div id="welcome-modal" class="welcome-modal hidden" role="dialog" aria-labelledby="welcome-title">
    <div class="welcome-modal-content">
        <button id="welcome-close-btn" class="welcome-close-btn" type="button" aria-label="Close welcome dialog">âœ•</button>
        <div class="welcome-modal-body">
            <h2 id="welcome-title" data-i18n="welcome.title">Until Every Cage is Empty</h2>
            <img src="assets/pig.jpg" alt="Pig in confinement" class="welcome-modal-image">
            
            <p data-i18n="welcome.p1"><strong>Secrecy and propaganda are their weapons.</strong> The animal agriculture industry relies on secrecy and propaganda to normalize systemic violence. This map destroys that cover, exposing over 54,000 locations where sentient beings are imprisoned, tested on, and slaughtered for profit.</p>

            <p data-i18n="welcome.p2"><strong>It is closer than you think.</strong> From factory farms to roadside zoos, this systematic abuse isn't distant, it is happening in your own backyard.</p>
            
            <p data-i18n="welcome.p3"><strong>Free and open source, forever.</strong> We provide the raw data necessary to force accountability and dismantle the system, built entirely on community contributions.</p>
            
            <p data-i18n="welcome.p4">Follow the guides on the <a href="howtouse.html" target="_self">How To Use</a> to be able to use this map effecitvely,
            and read our <a href="about.html" target="_self">About</a> page to learn how to contribute.</p>

            <button id="welcome-get-started-btn" class="welcome-get-started-btn" type="button" data-i18n="welcome.button">Explore the Map</button>
        </div>
    </div>
</div>
</div>




<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script type="module" src="app.js"></script>

<!-- Footer will be loaded here -->
<!-- <div id="footer-placeholder"></div>

<script src="footer.js"></script> -->
</body>
</html>